код на си++ работает намного быстрее - он при тех же параметрах дает результат 15-25 сек, что крайне меньше, чем 50(в питоне).